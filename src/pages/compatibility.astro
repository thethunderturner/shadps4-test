---
import Welcome from '../components/Welcome.astro';
import Layout from '../layouts/Layout.astro';
import {FaWindows, FaLinux, FaApple} from 'react-icons/fa';

const startWin = [
    {
        tag: 'Nothing',
        percent: 29.6,
        count: 185,
        total: 625,
    },
    {
        tag: 'Boots',
        percent: 19.52,
        count: 122,
        total: 625,
    },
    {
        tag: 'Menus',
        percent: 15.52,
        count: 97,
        total: 625,
    },
    {
        tag: 'Ingame',
        percent: 22.88,
        count: 143,
        total: 625,
    },
    {
        tag: 'Playable',
        percent: 12.48,
        count: 78,
        total: 625,
    },
];
const startLinux = [
    {
        tag: 'Nothing',
        percent: 32.49,
        count: 167,
        total: 514,
    },
    {
        tag: 'Boots',
        percent: 23.74,
        count: 122,
        total: 514,
    },
    {
        tag: 'Menus',
        percent: 12.84,
        count: 66,
        total: 514,
    },
    {
        tag: 'Ingame',
        percent: 19.26,
        count: 99,
        total: 514,
    },
    {
        tag: 'Playable',
        percent: 11.67,
        count: 60,
        total: 514,
    },
];
const startMac = [
    {
        tag: 'Nothing',
        percent: 46.6,
        count: 96,
        total: 206,
    },
    {
        tag: 'Boots',
        percent: 22.82,
        count: 47,
        total: 206,
    },
    {
        tag: 'Menus',
        percent: 14.08,
        count: 29,
        total: 206,
    },
    {
        tag: 'Ingame',
        percent: 13.11,
        count: 27,
        total: 206,
    },
    {
        tag: 'Playable',
        percent: 3.4,
        count: 7,
        total: 206,
    },
];
const colorByTag: Record<string, string> = {
    Nothing: 'bg-status-nothing',
    Boots: 'bg-status-boots',
    Menus: 'bg-status-menus',
    Ingame: 'bg-status-ingame',
    Playable: 'bg-status-playable',
};
---

<Layout title="Compatibility">
    <div class="flex justify-center gap-16">
        <!--Windows Tab-->
        <div class="flex max-h-full w-110 flex-col rounded-lg bg-compat-card p-4 border-border border">
            <!-- Header -->
            <div class="flex flex-row gap-x-4 border-b border-border pb-4">
                <FaWindows className="size-12 fill-gray-600 dark:fill-white" />
                <div class="flex flex-col">
                    <span class="text-xl font-normal text-gray-600 dark:text-white">Windows</span>
                    <span class="text-sm font-normal text-gray-600 dark:text-gray-300"
                    >Tested games: {startWin[0]['total']}</span
                    >
                </div>
            </div>
            <!-- Chart -->
            <div class="mt-4 flex flex-col gap-3 overflow-y-auto pr-1">
                {
                    startWin.map(({tag, count, percent, total}) => {
                        const widthPct = (count / total) * 100;
                        const barColor = colorByTag[tag] ?? 'bg-gray-500';

                        return (
                            <div class="flex flex-col gap-1">
                                <div class="flex items-baseline justify-between">
                                    <span class="text-sm text-gray-700 dark:text-gray-200">{tag}</span>
                                    <span class="text-xs tabular-nums text-gray-600 dark:text-gray-300">
                                        {count} â€¢ {percent.toFixed(2)}%
                                    </span>
                                </div>

                                {/* Accessible progress bar */}
                                <div
                                    class="h-3 w-full overflow-hidden rounded-full bg-gray-200/70 dark:bg-white/10"
                                    role="progressbar"
                                    aria-label={`${tag} games`}
                                    aria-valuemin={0}
                                    aria-valuenow={Math.round(widthPct)}
                                    aria-valuemax={100}
                                    title={`${count} games (${percent.toFixed(2)}%)`}
                                >
                                    <div class={`h-full ${barColor} rounded-full`} style={{width: `${widthPct}%`}} />
                                </div>
                            </div>
                        );
                    })
                }
            </div>
        </div>
        <!--Linux Tab-->
        <div class="flex h-80 w-110 flex-col rounded-lg bg-compat-card p-4 border-border border">
            <!-- Header -->
            <div class="flex flex-row gap-x-4 border-b border-border pb-4">
                <FaLinux className="size-12 fill-gray-600 dark:fill-white" />
                <div class="flex flex-col">
                    <span class="text-xl font-normal text-gray-600 dark:text-white">Linux</span>
                    <span class="text-sm font-normal text-gray-600 dark:text-gray-300"
                        >Tested games: {startLinux[0]['total']}</span
                    >
                </div>
            </div>
            <!-- Chart -->
            <div></div>
        </div>
        <!--macOS Tab-->
        <div class="flex h-80 w-110 flex-col rounded-lg bg-compat-card p-4 border-border border">
            <!-- Header -->
            <div class="flex flex-row gap-x-4 border-b border-border pb-4">
                <FaApple className="size-12 fill-gray-600 dark:fill-white" />
                <div class="flex flex-col">
                    <span class="text-xl font-normal text-gray-600 dark:text-white">macOS</span>
                    <span class="text-sm font-normal text-gray-600 dark:text-gray-300"
                        >Tested games: {startMac[0]['total']}</span
                    >
                </div>
            </div>
            <!-- Chart -->
            <div></div>
        </div>
    </div>
</Layout>
